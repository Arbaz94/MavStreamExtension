/**
 * Class: SimpleSampleClient_VideoQuery1
 * Original Author: Mayur Arora (mayur.arora@mavs.uta.edu)
 *
 * Indicate when a specific person (whose image or feature vector is given) entered the building.
 */


package edu.uta.dsms.client;

import edu.uta.dsms.client.Query;
import edu.uta.dsms.core.query.*;
import edu.uta.dsms.client.comm.*;

import com.thoughtworks.xstream.mapper.CannotResolveClassException;
import edu.uta.dsms.core.constants.SchedulingStrategy;
import edu.uta.dsms.core.streams.DataItem;

import java.io.ObjectInputStream;
import java.io.StringReader;
import java.net.Socket;
import java.util.ArrayList;

import java.util.Vector;

/**
 *
 * @author Mayur
 *
 * Indicate when 2 different people (given images or feature vectors) enter AND leave with in 10 minutes of each other
 *
 */



public class Thesis_Query5
{

    public static void main(String args[])
    {
        // point filename to a well-formed xml file
        // ensure that the dtd is available.
        try
        {
            // Setup QOS by creating a set of tuples arraylists, one
            // for each type of QOS policy, adding a new Tuple to each

            ArrayList<CQ_Tuple> tuples1 = new ArrayList<CQ_Tuple>();
            ArrayList<CQ_Tuple> tuples2 = new ArrayList<CQ_Tuple>();
            ArrayList<CQ_Tuple> tuples3 = new ArrayList<CQ_Tuple>();

            tuples1.add(new CQ_Tuple("1,0.01"));
            tuples2.add(new CQ_Tuple("1,0.2"));
            tuples3.add(new CQ_Tuple("1,0.3"));

            long startTime = 0L;
            long endTime = 10000L;

            ArrayList<CQ_QOS> qos = new ArrayList<CQ_QOS>();

            qos.add(new CQ_QOS("latency",    "ms", 1, 10, tuples1));
            qos.add(new CQ_QOS("memory",     "ms", 1, 10, tuples2));
            qos.add(new CQ_QOS("throughput", "ms", 1, 10, tuples3));



            CQ_Stream Lab_entry = new CQ_Stream(1,"Lab_entry","Lab_entry");
            CQ_Stream Lab_entry_2 = new CQ_Stream(1,"Lab_entry_2","Lab_entry_2");
            CQ_Stream Lab_exit = new CQ_Stream(2,"Lab_exit","Lab_exit");
            CQ_Stream Lab_exit_2 = new CQ_Stream(2,"Lab_exit_2","Lab_exit_2");


            CQ_Project project1= new CQ_Project(3,"project_1","Lab_entry.FrameId,Lab_entry.ObjectId,Lab_entry.PrevObjectId");//,Lab_entry.FrameId,Lab_entry.ObjectId");

            CQ_Project project2= new CQ_Project(3,"project_2","Lab_entry_2.FrameId,Lab_entry_2.ObjectId,Lab_entry_2.PrevObjectId");//,Lab_entry.FrameId,Lab_entry.ObjectId");

            CQ_Project project3= new CQ_Project(3,"project_3","Lab_exit.FrameId,Lab_exit.ObjectId,Lab_exit.PrevObjectId");//,Lab_entry.FrameId,Lab_entry.ObjectId");

            CQ_Project project4= new CQ_Project(3,"project_4","Lab_exit_2.FrameId,Lab_exit_2.ObjectId,Lab_exit_2.PrevObjectId");//,Lab_entry.FrameId,Lab_entry.ObjectId");


            CQ_Select select1 = new CQ_Select(13,"select1","sMatch(Lab_entry.FV,'[[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000015,0.000000,0.000030,0.000060,0.000060,0.000120,0.000299,0.000628,0.000792,0.001973,0.002631,0.004409,0.007398,0.009207,0.008325,0.007563,0.007847,0.006427,0.004813,0.005261,0.005052,0.004798,0.005022,0.004873,0.004678,0.004349,0.004947,0.003961,0.003542,0.003243,0.003258,0.002421,0.002646,0.002526,0.002197,0.002466,0.002735,0.003482,0.002780,0.002750,0.003049,0.003139,0.003154,0.003557,0.003318,0.003423,0.003288,0.003363,0.003572,0.004140,0.003991,0.003707,0.003722,0.003438,0.003408,0.003647,0.003482,0.003258,0.002929,0.003139,0.002765,0.002974,0.002705,0.002556,0.002900,0.002616,0.002690,0.002601,0.002675,0.002541,0.002466,0.003213,0.002302,0.002391,0.002660,0.002033,0.002376,0.002272,0.002481,0.002362,0.002182,0.002107,0.002197,0.002347,0.002885,0.002302,0.002526,0.002317,0.003109,0.002944,0.002929,0.002780,0.002646,0.002870,0.002900,0.003408,0.003124,0.003707,0.003871,0.004663,0.004021,0.004110,0.004245,0.004484,0.005485,0.006128,0.005859,0.006397,0.006337,0.006546,0.006472,0.007309,0.006935,0.007503,0.007070,0.007114,0.007443,0.006965,0.007219,0.006965,0.005874,0.005411,0.005859,0.005470,0.004603,0.004170,0.003662,0.003079,0.003154,0.002870,0.002586,0.002212,0.001764,0.001599,0.001405,0.001390,0.001510,0.001255,0.001495,0.001121,0.001435,0.001465,0.001315,0.001315,0.001868,0.001330,0.001510,0.001345,0.001405,0.001689,0.001674,0.001734,0.001838,0.001809,0.002242,0.002406,0.002287,0.002302,0.002436,0.002780,0.002362,0.002646,0.003034,0.002750,0.002362,0.002481,0.002959,0.003079,0.002795,0.002825,0.002750,0.002376,0.002391,0.002092,0.002347,0.002167,0.002332,0.002257,0.002496,0.002242,0.002526,0.002272,0.002601,0.003019,0.002929,0.002526,0.002929,0.002436,0.002915,0.002870,0.003662,0.003139,0.003273,0.002855,0.002601,0.003333,0.002616,0.002137,0.002466,0.002048,0.002197,0.001943,0.002317,0.002556,0.002541,0.002466,0.002451,0.002511,0.003318,0.002974,0.002526,0.002870,0.003333,0.003841,0.003856,0.004095,0.005470,0.006442,0.009760,0.017622,0.033046,0.095089,0.141901],[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000015,0.000075,0.000060,0.000209,0.000209,0.000254,0.000254,0.000598,0.000927,0.001779,0.002795,0.004828,0.007682,0.011987,0.010806,0.009954,0.009476,0.008744,0.007951,0.008071,0.007249,0.007503,0.005979,0.005351,0.005336,0.005605,0.005530,0.004334,0.003677,0.004589,0.003826,0.004319,0.004693,0.005396,0.005396,0.005620,0.005411,0.006233,0.004843,0.004932,0.005216,0.004992,0.004962,0.005515,0.004409,0.004589,0.003841,0.004050,0.004095,0.003886,0.003737,0.003796,0.003752,0.003034,0.003886,0.002989,0.003184,0.003587,0.002720,0.002900,0.002989,0.003961,0.003647,0.003647,0.003602,0.003811,0.003841,0.003946,0.003901,0.004618,0.004887,0.004947,0.004932,0.005216,0.005620,0.005949,0.006472,0.006397,0.006965,0.007802,0.008744,0.008699,0.008624,0.008579,0.008116,0.008206,0.007638,0.007907,0.007398,0.007324,0.007025,0.006412,0.006218,0.005739,0.005605,0.004753,0.005306,0.005545,0.004439,0.003841,0.003841,0.003228,0.002541,0.002900,0.002302,0.002362,0.002511,0.001719,0.001853,0.001943,0.001988,0.002182,0.001883,0.001988,0.001928,0.001988,0.002152,0.002302,0.001973,0.002122,0.001973,0.001973,0.002212,0.001898,0.002078,0.002078,0.001719,0.001883,0.001809,0.001779,0.001823,0.001525,0.001659,0.001285,0.001584,0.001704,0.001330,0.002018,0.002182,0.001838,0.001988,0.002317,0.001928,0.001704,0.001764,0.001719,0.001674,0.001689,0.001913,0.001659,0.001674,0.001764,0.001868,0.002003,0.001973,0.001898,0.002362,0.002466,0.002720,0.002063,0.001853,0.002167,0.002272,0.002272,0.002078,0.002018,0.001704,0.002048,0.001495,0.001345,0.001196,0.001106,0.001360,0.001136,0.001435,0.001315,0.001211,0.001226,0.001495,0.001121,0.001913,0.001584,0.001405,0.001838,0.001704,0.001794,0.002092,0.001883,0.002078,0.001823,0.002182,0.002362,0.002257,0.002018,0.002391,0.002033,0.002391,0.002107,0.002720,0.002735,0.002287,0.002810,0.003303,0.003587,0.004065,0.003064,0.003632,0.003199,0.003722,0.004708,0.004768,0.004349,0.004529,0.005216,0.004603,0.004364,0.003991,0.003512,0.003557,0.003154,0.003094,0.002870,0.002855,0.003094,0.002840,0.003333,0.004305,0.004290,0.004050,0.004409,0.004379,0.004514,0.005112,0.006801,0.010358,0.018399,0.139614],[0.001823,0.000374,0.000224,0.000418,0.000463,0.000448,0.000613,0.000717,0.000822,0.000927,0.001196,0.001390,0.001719,0.001838,0.002481,0.003393,0.003737,0.005246,0.006756,0.009999,0.013198,0.017263,0.019684,0.016531,0.011897,0.011464,0.009835,0.008848,0.008325,0.007653,0.007533,0.007563,0.007458,0.007787,0.008385,0.007563,0.008280,0.008699,0.010104,0.009177,0.009102,0.008041,0.008833,0.008953,0.010522,0.009596,0.011060,0.012824,0.013511,0.015141,0.015574,0.015724,0.016516,0.017906,0.017592,0.018220,0.017876,0.017966,0.015604,0.015843,0.014020,0.011793,0.011255,0.010104,0.008744,0.007817,0.008086,0.005829,0.006397,0.005396,0.005680,0.004887,0.004364,0.004887,0.004708,0.004648,0.004245,0.004185,0.003826,0.003453,0.003453,0.003826,0.003453,0.003034,0.003094,0.002347,0.002137,0.002137,0.002421,0.002601,0.002302,0.002541,0.002810,0.002481,0.002287,0.002915,0.002287,0.002003,0.003004,0.002959,0.002332,0.002900,0.002287,0.002317,0.002063,0.002376,0.001913,0.002122,0.001943,0.002212,0.002601,0.002018,0.002107,0.001614,0.001674,0.001943,0.001390,0.001450,0.001166,0.001465,0.001226,0.001181,0.001121,0.001226,0.001061,0.001136,0.000972,0.000912,0.001031,0.001226,0.000942,0.001091,0.000957,0.000837,0.001106,0.001016,0.001166,0.001181,0.001106,0.000986,0.000972,0.000777,0.000822,0.001016,0.000762,0.000867,0.000912,0.000732,0.000837,0.000717,0.000613,0.000732,0.000897,0.000852,0.001211,0.000702,0.000912,0.000673,0.000777,0.001076,0.000912,0.000986,0.001061,0.000762,0.000927,0.000777,0.000897,0.000852,0.001136,0.001211,0.000822,0.000837,0.000957,0.000882,0.000942,0.000897,0.001255,0.001211,0.001629,0.001794,0.001584,0.001390,0.001330,0.001330,0.001345,0.000897,0.000986,0.001330,0.000957,0.001525,0.001151,0.001629,0.001211,0.001689,0.001629,0.001779,0.001420,0.001226,0.001360,0.001435,0.000702,0.000747,0.000986,0.000747,0.001046,0.000942,0.000598,0.000568,0.000389,0.000643,0.000583,0.000613,0.000404,0.001121,0.000314,0.001031,0.001016,0.000957,0.000643,0.000972,0.000553,0.000986,0.000658,0.001091,0.001465,0.001061,0.000897,0.001345,0.000837,0.005336,0.000732,0.002556,0.000732,0.002855,0.002586,0.002317,0.002690,0.010298,0.001823,0.027292,0.003856,0.023585,0.030072,0.006487,0.000986,0.002705,0.000568,0.002212,0.000717,0.001270,0.000867,0.000284,0.000239,0.000105,0.000090,0.000000]]','0.0004') && Lab_entry.PrevObjectId=='120'");

            CQ_Select select2 = new CQ_Select(23,"select2","sMatch(Lab_entry_2.FV,'[[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000043,0.000050,0.000128,0.000178,0.000392,0.000449,0.001156,0.001898,0.001905,0.003282,0.002968,0.003146,0.004145,0.004202,0.002469,0.002340,0.002190,0.001941,0.003289,0.002611,0.002212,0.001912,0.002240,0.002198,0.002355,0.001698,0.001712,0.001313,0.001398,0.001313,0.001398,0.001348,0.001348,0.001470,0.001363,0.001448,0.001427,0.001705,0.001812,0.002162,0.002119,0.002205,0.002219,0.002148,0.001748,0.001884,0.001926,0.001577,0.001505,0.001334,0.001641,0.001534,0.001612,0.001605,0.001563,0.001748,0.001363,0.001391,0.001448,0.001341,0.001498,0.001334,0.001134,0.001370,0.001477,0.001313,0.001348,0.001035,0.001277,0.001249,0.001199,0.001049,0.001127,0.001113,0.001206,0.001213,0.001113,0.001220,0.001306,0.001313,0.001070,0.000992,0.001020,0.001284,0.001027,0.001070,0.001341,0.001320,0.001192,0.001206,0.001341,0.001356,0.001705,0.001869,0.001755,0.001948,0.001998,0.002340,0.002697,0.003068,0.002404,0.002676,0.002818,0.002818,0.002861,0.002854,0.003168,0.003325,0.003639,0.003525,0.004017,0.004895,0.005544,0.006008,0.006750,0.006757,0.006400,0.006029,0.005658,0.006514,0.007171,0.007413,0.007913,0.008469,0.009810,0.010317,0.009875,0.009475,0.010017,0.010531,0.010981,0.009061,0.006971,0.005686,0.004873,0.004588,0.004352,0.004053,0.004359,0.003739,0.004331,0.003696,0.003132,0.003667,0.004238,0.004038,0.004388,0.003468,0.003510,0.004288,0.003553,0.003653,0.003646,0.003824,0.003660,0.002469,0.002062,0.002390,0.002012,0.002098,0.002198,0.001634,0.001784,0.002083,0.002183,0.003011,0.003139,0.002718,0.001363,0.001284,0.001177,0.001006,0.000913,0.001006,0.001106,0.000928,0.000856,0.000856,0.000913,0.001134,0.001134,0.001077,0.001256,0.001605,0.001284,0.001241,0.001620,0.001798,0.001484,0.001398,0.001534,0.001548,0.001370,0.001384,0.001227,0.001505,0.001270,0.001527,0.001641,0.001955,0.001998,0.002098,0.002169,0.002026,0.002176,0.002440,0.003674,0.003475,0.004302,0.005208,0.006293,0.007299,0.009860,0.010039,0.012193,0.017809,0.016182,0.019000,0.016653,0.018408,0.018379,0.016967,0.014113,0.011651,0.014006,0.014427,0.017259,0.015575,0.012864,0.015283,0.017794,0.020085,0.030031,0.088651],[0.000007,0.000000,0.000000,0.000021,0.000029,0.000036,0.000029,0.000029,0.000057,0.000050,0.000086,0.000093,0.000228,0.000164,0.000250,0.000364,0.000507,0.000792,0.001712,0.002576,0.004381,0.004181,0.004138,0.004267,0.005180,0.004752,0.003781,0.003710,0.003781,0.003639,0.003425,0.003746,0.004752,0.003938,0.004502,0.003874,0.004523,0.004260,0.004581,0.004795,0.004638,0.004224,0.005073,0.005587,0.006457,0.009090,0.010274,0.010560,0.009789,0.010082,0.011544,0.013157,0.011958,0.011801,0.009739,0.008298,0.007392,0.007720,0.008127,0.008961,0.006742,0.006700,0.007563,0.007506,0.006742,0.005294,0.005073,0.005351,0.006129,0.005672,0.004616,0.003196,0.002925,0.002897,0.002940,0.003104,0.003311,0.002775,0.003154,0.003674,0.003453,0.003311,0.003988,0.004616,0.004416,0.005216,0.004944,0.004916,0.004895,0.005629,0.005180,0.005537,0.005301,0.004452,0.004852,0.004859,0.004523,0.004538,0.004773,0.005037,0.005715,0.005465,0.005572,0.005401,0.005679,0.005979,0.005166,0.004895,0.004516,0.004060,0.003396,0.002975,0.002604,0.002019,0.001841,0.001527,0.001313,0.001177,0.000935,0.000920,0.000878,0.000756,0.000649,0.000678,0.000621,0.000835,0.000799,0.000821,0.001077,0.001156,0.001006,0.000949,0.001020,0.000821,0.000913,0.000949,0.000842,0.000870,0.000813,0.000878,0.000756,0.001070,0.000813,0.000706,0.000842,0.000621,0.000507,0.000892,0.000728,0.000771,0.000742,0.000685,0.000728,0.000792,0.000699,0.000721,0.000785,0.000913,0.000721,0.000578,0.000721,0.000749,0.000778,0.000763,0.000878,0.000849,0.001163,0.000849,0.000821,0.001277,0.000977,0.001092,0.000813,0.000899,0.000806,0.000870,0.001320,0.000999,0.001070,0.001520,0.001120,0.000928,0.000977,0.001027,0.001106,0.001249,0.001270,0.001199,0.001156,0.001192,0.001327,0.001277,0.001406,0.001627,0.002169,0.001812,0.001805,0.002540,0.002540,0.002190,0.002540,0.003888,0.003025,0.003846,0.004152,0.004409,0.003746,0.004024,0.004859,0.005708,0.006471,0.007656,0.007477,0.010367,0.009004,0.007791,0.009061,0.014391,0.014491,0.014812,0.016317,0.014883,0.013028,0.011466,0.009917,0.009903,0.011765,0.008391,0.007121,0.005922,0.005094,0.006821,0.006193,0.005030,0.005187,0.004845,0.003896,0.005216,0.005002,0.005273,0.005180,0.005315,0.008041,0.006065,0.005337,0.004595,0.005073,0.006992,0.007335,0.003418,0.003468,0.003753,0.002954,0.003482,0.005858,0.011958],[0.003510,0.000771,0.000863,0.001035,0.001127,0.001184,0.001334,0.001548,0.001605,0.001983,0.002483,0.003132,0.003924,0.005237,0.006771,0.008933,0.011209,0.010909,0.013970,0.016703,0.017744,0.018822,0.021048,0.023823,0.025136,0.025072,0.022375,0.021019,0.017224,0.015476,0.012864,0.009125,0.007748,0.006136,0.004816,0.004516,0.003988,0.003539,0.003589,0.003596,0.003839,0.004003,0.004438,0.004887,0.005280,0.005758,0.006286,0.007106,0.007962,0.008398,0.008305,0.008112,0.008098,0.008020,0.008184,0.008219,0.007941,0.007413,0.006557,0.005608,0.004902,0.003967,0.003389,0.002740,0.002412,0.002055,0.001769,0.001720,0.001434,0.001670,0.001277,0.001420,0.001142,0.001249,0.001398,0.001234,0.001127,0.000892,0.000913,0.000999,0.000892,0.000671,0.000863,0.000692,0.000728,0.000856,0.000649,0.000756,0.000970,0.000835,0.000956,0.000963,0.000920,0.000742,0.000885,0.000985,0.000813,0.000799,0.000813,0.000735,0.000835,0.000713,0.000785,0.000828,0.000735,0.000778,0.000692,0.000692,0.000699,0.000721,0.000742,0.000906,0.000792,0.000706,0.001092,0.000992,0.001077,0.001313,0.001249,0.001334,0.001084,0.001184,0.001291,0.001448,0.001277,0.001398,0.001441,0.001655,0.001541,0.001627,0.001548,0.001627,0.002226,0.003125,0.003489,0.002954,0.003517,0.002661,0.002947,0.002961,0.002362,0.004245,0.003660,0.006478,0.004374,0.004623,0.003368,0.004823,0.003817,0.004003,0.004730,0.002797,0.004388,0.003867,0.003175,0.005801,0.004702,0.003432,0.002618,0.001363,0.001677,0.000970,0.000977,0.000992,0.000956,0.001377,0.001876,0.001898,0.002247,0.002433,0.002561,0.002098,0.002854,0.003004,0.003339,0.003996,0.005537,0.007285,0.010239,0.007756,0.007870,0.009475,0.008012,0.008819,0.006314,0.008098,0.006307,0.006500,0.007484,0.009225,0.008826,0.007770,0.006293,0.006885,0.008184,0.006272,0.004902,0.005629,0.005044,0.004980,0.003967,0.004502,0.004609,0.004488,0.004345,0.003931,0.003268,0.003974,0.004409,0.005151,0.004638,0.005216,0.005637,0.003910,0.004488,0.002098,0.002412,0.002968,0.003061,0.004581,0.001684,0.002397,0.000863,0.007549,0.001670,0.000892,0.000778,0.001070,0.000421,0.000842,0.000200,0.000564,0.000114,0.000407,0.000057,0.000036,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000]]','0.0004')");

            CQ_Select select3 = new CQ_Select(25,"select3","sMatch(Lab_exit.FV, '[[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000014,0.000000,0.000014,0.000000,0.000000,0.000014,0.000000,0.000056,0.000127,0.000621,0.001228,0.001849,0.002724,0.003105,0.004361,0.006337,0.006421,0.007917,0.006958,0.007071,0.005137,0.006788,0.008270,0.005800,0.004714,0.005645,0.004474,0.004446,0.004700,0.004615,0.003641,0.003161,0.003218,0.003288,0.002992,0.003302,0.003034,0.002611,0.002893,0.002639,0.002470,0.002554,0.002484,0.002075,0.002145,0.002681,0.002653,0.002766,0.002526,0.002188,0.002625,0.002371,0.002526,0.002583,0.002103,0.002879,0.002498,0.003514,0.003599,0.003302,0.003557,0.003317,0.002921,0.002950,0.003246,0.002738,0.002667,0.002597,0.002188,0.002780,0.002117,0.001877,0.001905,0.001976,0.001750,0.001806,0.001905,0.001891,0.001581,0.001538,0.001482,0.001736,0.001764,0.001454,0.001736,0.002004,0.002329,0.001990,0.002117,0.002230,0.002075,0.002131,0.002286,0.002484,0.002173,0.002286,0.002484,0.002780,0.003175,0.002597,0.003048,0.003091,0.003359,0.003811,0.004262,0.004474,0.004756,0.005603,0.006252,0.006506,0.007946,0.008623,0.009922,0.010034,0.011375,0.012321,0.012067,0.011530,0.011686,0.010514,0.010232,0.009879,0.008976,0.008299,0.006859,0.006182,0.005504,0.005815,0.003952,0.003966,0.003105,0.002427,0.001750,0.001411,0.001214,0.001298,0.001129,0.001002,0.001101,0.001073,0.000903,0.001157,0.001228,0.001186,0.001157,0.001058,0.001030,0.001016,0.001087,0.000974,0.001101,0.001313,0.000988,0.001341,0.001186,0.001341,0.001256,0.001538,0.001877,0.001806,0.001778,0.001778,0.002018,0.001552,0.001524,0.001284,0.001454,0.001552,0.001933,0.001538,0.001708,0.001722,0.001891,0.002004,0.002046,0.002075,0.002357,0.002131,0.002343,0.002413,0.002456,0.002343,0.002653,0.003048,0.002893,0.002681,0.002667,0.002766,0.002230,0.002272,0.002315,0.002258,0.002089,0.002526,0.002823,0.002667,0.003218,0.003147,0.003063,0.003288,0.003147,0.003161,0.003091,0.003627,0.003655,0.003345,0.002498,0.002597,0.003034,0.003246,0.003302,0.002950,0.002992,0.003274,0.003345,0.003853,0.003359,0.003923,0.004615,0.005462,0.006803,0.008835,0.015778,0.033138,0.094600,0.143615],[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000028,0.000000,0.000000,0.000000,0.000000,0.000000,0.000014,0.000028,0.000071,0.000071,0.000071,0.000127,0.000155,0.000339,0.000494,0.000776,0.003655,0.006859,0.007452,0.009809,0.012109,0.008129,0.008482,0.007466,0.008411,0.008581,0.007565,0.006224,0.007296,0.006436,0.005165,0.005250,0.004657,0.004996,0.003980,0.004163,0.004629,0.004234,0.004333,0.003528,0.004050,0.003811,0.003740,0.003232,0.003486,0.003740,0.003613,0.004389,0.004559,0.004671,0.004403,0.004686,0.003952,0.003853,0.003811,0.003486,0.003415,0.003020,0.002907,0.002794,0.002681,0.002470,0.002526,0.002075,0.002456,0.002865,0.002794,0.002823,0.003288,0.003190,0.003345,0.003500,0.003571,0.003867,0.003782,0.003514,0.004516,0.004883,0.005405,0.006097,0.006012,0.007452,0.007635,0.007536,0.008284,0.009230,0.009936,0.010909,0.011545,0.012208,0.012462,0.011940,0.012363,0.011657,0.011121,0.010119,0.008651,0.008637,0.007212,0.006351,0.005984,0.005617,0.003909,0.004036,0.002921,0.002583,0.002018,0.002343,0.002173,0.001792,0.001440,0.001524,0.001482,0.001609,0.001440,0.001609,0.001581,0.001454,0.001778,0.001863,0.001679,0.001284,0.001835,0.001665,0.001595,0.001948,0.001764,0.001835,0.001651,0.001736,0.001891,0.002075,0.001764,0.001835,0.001863,0.001933,0.001736,0.001341,0.001722,0.001609,0.001510,0.001694,0.001468,0.001736,0.001214,0.001355,0.001595,0.001665,0.001933,0.001425,0.001327,0.001496,0.001538,0.001270,0.001341,0.001298,0.001355,0.001270,0.001425,0.001468,0.001440,0.001200,0.001454,0.001581,0.001538,0.001425,0.001764,0.001651,0.002075,0.001863,0.001990,0.002315,0.002159,0.002272,0.002329,0.002780,0.001877,0.001976,0.001651,0.001411,0.001369,0.001313,0.001383,0.001355,0.001524,0.001651,0.001736,0.001609,0.001835,0.002145,0.002484,0.002202,0.002357,0.002329,0.002244,0.001948,0.002512,0.001976,0.002286,0.002046,0.002075,0.002456,0.002371,0.002202,0.002032,0.001891,0.001976,0.002032,0.002597,0.002343,0.002794,0.002639,0.002540,0.002399,0.002230,0.002653,0.002371,0.002371,0.002159,0.002809,0.002879,0.002936,0.003571,0.002907,0.003514,0.003641,0.003345,0.003486,0.003740,0.003839,0.003585,0.003147,0.003458,0.003514,0.004177,0.003938,0.004093,0.005250,0.006944,0.009696,0.011502,0.025615,0.153819],[0.001948,0.000183,0.000268,0.000240,0.000296,0.000325,0.000466,0.000635,0.000466,0.000480,0.000875,0.000833,0.000903,0.001228,0.001637,0.002696,0.004700,0.008496,0.011418,0.012857,0.010486,0.011784,0.013549,0.013168,0.015468,0.014776,0.011389,0.008355,0.007579,0.007607,0.006563,0.006803,0.007649,0.008030,0.008595,0.007649,0.009371,0.008962,0.008990,0.009075,0.008242,0.008073,0.009343,0.009004,0.010190,0.010232,0.012236,0.013168,0.014692,0.015708,0.016569,0.016837,0.017684,0.018855,0.017853,0.018700,0.017754,0.016752,0.015468,0.014692,0.013153,0.011276,0.010147,0.009682,0.007861,0.007226,0.005899,0.005476,0.004954,0.004276,0.004446,0.003867,0.004206,0.004036,0.003387,0.003542,0.003952,0.003895,0.003557,0.003613,0.003669,0.003204,0.003952,0.003077,0.003091,0.003472,0.003331,0.003260,0.002780,0.003260,0.002794,0.003811,0.003938,0.003472,0.002710,0.003020,0.003218,0.003048,0.002484,0.002611,0.002498,0.002300,0.002272,0.002442,0.002244,0.002004,0.002202,0.001821,0.001792,0.001440,0.001567,0.001567,0.001468,0.001468,0.001157,0.001341,0.001510,0.001284,0.001552,0.001157,0.001087,0.001002,0.000776,0.000692,0.000607,0.000762,0.000960,0.000833,0.000706,0.000565,0.000663,0.000565,0.000593,0.000692,0.000508,0.000819,0.000720,0.000607,0.000466,0.000508,0.000466,0.000607,0.000395,0.000536,0.000522,0.000536,0.000438,0.000353,0.000565,0.000409,0.000466,0.000423,0.000480,0.000522,0.000550,0.000466,0.000635,0.000621,0.000536,0.000677,0.000677,0.000508,0.000847,0.000536,0.000536,0.000565,0.000593,0.000381,0.000452,0.000452,0.000677,0.000522,0.000494,0.000621,0.000593,0.000593,0.000607,0.000607,0.000508,0.000621,0.000649,0.000565,0.000579,0.000522,0.000579,0.000706,0.000988,0.000776,0.001595,0.001538,0.001369,0.001567,0.001877,0.001891,0.001369,0.001298,0.001143,0.001496,0.000804,0.001157,0.001313,0.001143,0.001186,0.001087,0.000847,0.001510,0.001214,0.001355,0.000903,0.001552,0.000762,0.001933,0.001044,0.001806,0.001665,0.002964,0.001440,0.001397,0.001143,0.002188,0.001270,0.001369,0.001044,0.001567,0.002343,0.004149,0.000903,0.004573,0.001284,0.004587,0.001157,0.004333,0.001482,0.005335,0.007395,0.003444,0.003048,0.005250,0.002131,0.026222,0.002357,0.031162,0.014480,0.003359,0.002188,0.004700,0.002202,0.019053,0.001256,0.000974,0.000833,0.000367,0.000212,0.000296,0.000409,0.000042]]','0.0004')");

            CQ_Select select4 = new CQ_Select(24,"select4","sMatch(Lab_exit_2.FV, '[[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000008,0.000016,0.000000,0.000031,0.000000,0.000047,0.000016,0.000070,0.000031,0.000047,0.000063,0.000063,0.000063,0.000109,0.000227,0.000547,0.001064,0.001533,0.001814,0.002315,0.001979,0.001681,0.001462,0.001791,0.001979,0.004239,0.004817,0.006765,0.006108,0.005889,0.005443,0.005302,0.005818,0.005623,0.005928,0.006452,0.004888,0.004215,0.003926,0.003433,0.003676,0.003167,0.003003,0.002831,0.003175,0.003136,0.002651,0.002987,0.002612,0.002714,0.002487,0.002948,0.002831,0.002510,0.004035,0.003558,0.003676,0.003331,0.003316,0.003136,0.003253,0.002776,0.002894,0.003136,0.002839,0.003199,0.002831,0.002995,0.002972,0.002526,0.002682,0.002761,0.002956,0.002503,0.002815,0.002714,0.002557,0.002416,0.002229,0.002166,0.002088,0.002104,0.002057,0.001681,0.001767,0.002072,0.002111,0.001877,0.002111,0.002088,0.001893,0.002104,0.001963,0.002119,0.002237,0.002338,0.002440,0.002198,0.002409,0.002440,0.002416,0.002510,0.002628,0.003152,0.003230,0.003504,0.003566,0.003871,0.003957,0.003988,0.004731,0.005552,0.005380,0.005232,0.006006,0.005631,0.006178,0.006663,0.006991,0.007734,0.007992,0.008814,0.009486,0.009791,0.009861,0.010104,0.010362,0.009768,0.009854,0.008681,0.008516,0.007812,0.006882,0.006452,0.005592,0.005208,0.006217,0.005021,0.004598,0.004309,0.004536,0.004809,0.003855,0.004223,0.003120,0.003707,0.002667,0.002800,0.002307,0.002800,0.002448,0.003504,0.002878,0.002972,0.002096,0.002847,0.002291,0.002143,0.001603,0.001744,0.001509,0.001283,0.001220,0.001494,0.001447,0.001384,0.001251,0.001142,0.001275,0.001275,0.001290,0.001423,0.001361,0.001243,0.001189,0.001267,0.001329,0.001517,0.001392,0.001533,0.001400,0.001415,0.001400,0.001298,0.001204,0.001322,0.001243,0.001126,0.001189,0.001118,0.001032,0.001064,0.001228,0.001243,0.001165,0.001142,0.001197,0.001556,0.001384,0.001298,0.001674,0.001689,0.001861,0.002518,0.002894,0.003308,0.002995,0.002526,0.002909,0.002456,0.002377,0.002682,0.002471,0.002690,0.002956,0.002761,0.002894,0.003081,0.003707,0.003926,0.004442,0.004207,0.004153,0.004278,0.004098,0.003973,0.004395,0.004661,0.005357,0.006436,0.008579,0.011785,0.024478,0.093836,0.146615],[0.000000,0.000008,0.000008,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000008,0.000016,0.000023,0.000023,0.000031,0.000039,0.000031,0.000039,0.000047,0.000086,0.000149,0.000227,0.000188,0.000282,0.000454,0.000813,0.000884,0.001376,0.001947,0.002221,0.002628,0.003464,0.004731,0.008141,0.008993,0.008907,0.008454,0.008939,0.007883,0.007257,0.007077,0.006178,0.005474,0.006115,0.006264,0.007070,0.005943,0.006069,0.005693,0.005740,0.006061,0.006069,0.007030,0.006772,0.007054,0.008117,0.008532,0.008407,0.008767,0.007820,0.007437,0.006483,0.006960,0.006804,0.006984,0.006076,0.006538,0.005568,0.005419,0.004880,0.004942,0.004176,0.004598,0.003981,0.004223,0.004301,0.003848,0.004035,0.004043,0.003981,0.003965,0.004113,0.004520,0.004551,0.005005,0.005310,0.005560,0.006123,0.006608,0.006467,0.006968,0.006765,0.006420,0.006514,0.007101,0.006999,0.007805,0.008477,0.008571,0.009259,0.009854,0.010370,0.011738,0.012442,0.011949,0.012231,0.013224,0.012082,0.010964,0.009869,0.008931,0.008313,0.008626,0.007171,0.006413,0.005936,0.005787,0.004942,0.005764,0.004559,0.004473,0.004035,0.004708,0.003848,0.003089,0.002612,0.002330,0.002135,0.002151,0.001533,0.001572,0.001509,0.001369,0.001423,0.001337,0.001345,0.001384,0.001517,0.001533,0.001423,0.001603,0.001259,0.001595,0.001588,0.001517,0.001861,0.001455,0.001541,0.001533,0.001337,0.001548,0.001322,0.001392,0.001165,0.001189,0.001197,0.001314,0.001337,0.001361,0.001197,0.001228,0.000993,0.000774,0.000821,0.000727,0.000719,0.000751,0.000813,0.000571,0.000633,0.000657,0.000751,0.000610,0.000743,0.000845,0.000923,0.000962,0.000931,0.001275,0.000892,0.000845,0.001283,0.001345,0.001361,0.001408,0.000962,0.001017,0.000798,0.000766,0.000798,0.000915,0.001071,0.000915,0.000673,0.000680,0.000665,0.000649,0.000766,0.000805,0.000735,0.000680,0.000618,0.000876,0.000899,0.000837,0.000923,0.000868,0.000978,0.000876,0.000946,0.001040,0.000931,0.000993,0.001032,0.001157,0.001064,0.001001,0.001134,0.001189,0.001103,0.000876,0.001087,0.001095,0.001290,0.001408,0.001447,0.001408,0.001611,0.001767,0.001674,0.001853,0.002049,0.001861,0.002487,0.003058,0.003089,0.003159,0.002980,0.002416,0.002534,0.001822,0.001869,0.002198,0.001314,0.001642,0.002143,0.002542,0.002917,0.003339,0.003238,0.002745,0.002518,0.003050,0.002831,0.004356,0.020348,0.146029],[0.000852,0.000227,0.000305,0.000391,0.000469,0.000547,0.000673,0.000845,0.000954,0.001165,0.001502,0.001697,0.001822,0.002925,0.003433,0.004176,0.005748,0.006811,0.008024,0.008407,0.011034,0.014898,0.015758,0.017768,0.017979,0.017486,0.015414,0.013060,0.012763,0.011942,0.012333,0.010964,0.012638,0.011269,0.010354,0.010307,0.009682,0.010292,0.009212,0.009463,0.009486,0.008548,0.008274,0.008016,0.008329,0.007914,0.009072,0.009877,0.010166,0.010956,0.013326,0.013646,0.014632,0.015132,0.016829,0.018135,0.018745,0.019121,0.016501,0.016118,0.014976,0.012583,0.011230,0.009463,0.007836,0.006694,0.005787,0.005021,0.004160,0.003394,0.003167,0.002933,0.002424,0.002338,0.002158,0.001939,0.001736,0.001705,0.001541,0.001697,0.001392,0.001588,0.001408,0.001384,0.001322,0.001314,0.001423,0.001259,0.001322,0.001275,0.001259,0.001173,0.000985,0.001032,0.001134,0.001017,0.000837,0.000899,0.000774,0.001040,0.001204,0.001306,0.001243,0.001392,0.001212,0.001400,0.001142,0.001329,0.001697,0.001118,0.001181,0.001048,0.001189,0.001024,0.001009,0.000899,0.001126,0.000931,0.000884,0.000970,0.001048,0.000790,0.000954,0.000946,0.000727,0.000633,0.000587,0.000774,0.000680,0.000680,0.000766,0.000594,0.000727,0.000837,0.000626,0.000719,0.000633,0.000657,0.000798,0.000602,0.000673,0.000618,0.000610,0.000790,0.000610,0.000712,0.000571,0.000688,0.000774,0.000657,0.000805,0.000774,0.000837,0.000821,0.000751,0.000837,0.000805,0.000860,0.000774,0.000907,0.000938,0.000899,0.000931,0.000923,0.000978,0.000993,0.001173,0.001611,0.001329,0.001236,0.001634,0.001361,0.001408,0.001814,0.001853,0.001924,0.001791,0.001666,0.001314,0.001728,0.001791,0.001752,0.002307,0.002909,0.003683,0.003089,0.003050,0.003128,0.003042,0.002659,0.003496,0.002604,0.002291,0.002510,0.002354,0.002135,0.001650,0.001447,0.001400,0.001173,0.000946,0.000954,0.001189,0.000743,0.000868,0.001204,0.000860,0.000766,0.000876,0.000805,0.000798,0.000915,0.000649,0.000852,0.000547,0.000907,0.000970,0.000719,0.000688,0.000805,0.000696,0.001212,0.000782,0.000946,0.001134,0.001806,0.000688,0.002088,0.000688,0.002323,0.000970,0.006108,0.001470,0.001869,0.003363,0.001924,0.002589,0.003699,0.001392,0.021443,0.002354,0.028435,0.016133,0.011957,0.000712,0.004903,0.000524,0.015351,0.000407,0.013905,0.004043,0.002479,0.001556,0.008258,0.000109,0.000657]]','0.0004')");

            CQ_Arrable arrable1=new CQ_Arrable(7,"arrable1","Lab_entry.PrevObjectId","Lab_entry.FrameId");

            CQ_Arrable arrable2=new CQ_Arrable(27,"arrable2","Lab_entry_2.PrevObjectId","Lab_entry_2.FrameId");

            CQ_Arrable arrable3=new CQ_Arrable(7,"arrable1","Lab_exit.PrevObjectId","Lab_exit.FrameId");

            CQ_Arrable arrable4=new CQ_Arrable(27,"arrable2","Lab_exit_2.PrevObjectId","Lab_exit_2.FrameId");


            CQ_Filter filter1=new CQ_Filter(9,"Filter1","Lab_entry.PrevObjectId","Lab_entry.FrameId","first");

            CQ_Filter filter2=new CQ_Filter(29,"Filter2","Lab_entry_2.PrevObjectId","Lab_entry_2.FrameId","first");

            CQ_Filter filter3=new CQ_Filter(9,"Filter1","Lab_exit.PrevObjectId","Lab_exit.FrameId","first");

            CQ_Filter filter4=new CQ_Filter(29,"Filter2","Lab_exit_2.PrevObjectId","Lab_exit_2.FrameId","first");


            CQ_OrderBy order1=new CQ_OrderBy(17,"order1","Lab_entry.tbSourceTS","desc");

            CQ_GroupBy  groupBy1 = new CQ_GroupBy(14,
                    "groupBy1",
                    "Lab_entry.tbSourceTS",
                    "count",
                    "Lab_entry.tbSourceTS",
                    "Lab_entry.tbSourceTS");

            CQ_sMatch match1 = new CQ_sMatch(5,"match1","Lab_entry.FV","Lab_entry.FV","0.0005");

            CQ_Join join1=new CQ_Join(30,"join1","Lab_entry.tbSourceTS < Lab_entry_2.tbSourceTS ");
            CQ_Join join2=new CQ_Join(30,"join2","Lab_exit.tbSourceTS < Lab_exit_2.tbSourceTS ");
            CQ_Join join3=new CQ_Join(30,"join3","Lab_entry_2.PrevObjectId =='120' && Lab_exit.PrevObjectId =='15');// < Lab_exit_2.tbSourceTS ");

            //3-33
            //4-48
            //2-19
            //1-8

            project1.addInput(filter1);
            project2.addInput(filter2);
            project3.addInput(filter3);
            project4.addInput(filter4);
            arrable1.addInput(select1);
            arrable2.addInput(select2);
            arrable3.addInput(select3);
            arrable4.addInput(select4);
            order1.addInput(select1);
            filter1.addInput(arrable1);
            filter2.addInput(arrable2);
            filter3.addInput(arrable3);
            filter4.addInput(arrable4);
            groupBy1.addInput(select1);
            select1.addInput(Lab_entry);
            select2.addInput(Lab_entry_2);
            join1.addInput(select1);
            join1.addInput(select2);
            join2.addInput(select3);
            join2.addInput(select4);
            match1.addInput(select1);
            match1.addInput(Lab_exit);
            select3.addInput(Lab_exit);
            select4.addInput(Lab_exit_2);
            join3.addInput(join1);
            join2.addInput(join2);

            // project1


            CQ_ClientQuery cq = new CQ_ClientQuery(
                    new CQ_ContinuousQuery(
                            "testQuery",
                            qos,
                            select1,
                            startTime,
                            endTime,
                            Long.parseLong("0"),Long.parseLong("20"),Long.parseLong("20"),
                            SchedulingStrategy.RoundRobinSS.toString(),
                            "null",
                            10));



            // take what was read and serialize it back to XML
            System.out.println("Object Serialization to XML *****************");
            System.out.println(QueryBuilder.toXML(cq));
            System.out.println("*********************************************");

            Query q = new Query(new StringReader(QueryBuilder.toXML(cq)));
            Socket responseSock = q.execute(new ServerDefinition("localhost", 8000));

            ObjectInputStream ois = new ObjectInputStream(responseSock.getInputStream());

            while (true)
            {
                String resp = (String)ois.readObject();
                System.out.print(resp);
                if ("endQuery".equalsIgnoreCase(resp.trim()))
                    break;
            }

            ois.close();
            responseSock.close();

        }
        catch (CannotResolveClassException crce)
        {
            System.err.println(crce.getMessage());
            crce.printStackTrace();
            System.exit(-1);
        }
        catch (Throwable t)
        {
            System.err.println("Caught: " + t);
            t.printStackTrace();
        }
    }



}
